<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Estoque IoT ‚Äì Fluxo & Arara</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <link rel="stylesheet" href="css/style.css" />

</head>

<body>
  <div class="app">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="brand">
        <div class="logo">üí°</div>
        <h1>Estoque IoT</h1>
      </div>

      <div class="nav">
        <button class="active">üìä Dashboard</button>
        <button>üß• Itens</button>
        <button>üìú Detalhamento</button>
      </div>

      <section class="filters">
        <h3>Filtros</h3>
        <div class="filter-group">
          <label>Ano</label>
          <div class="checks" id="filtro-ano">
            <div class="row"><input type="checkbox" value="2021" checked> <span>2021</span></div>
            <div class="row"><input type="checkbox" value="2022" checked> <span>2022</span></div>
            <div class="row"><input type="checkbox" value="2023" checked> <span>2023</span></div>
            <div class="row"><input type="checkbox" value="2024" checked> <span>2024</span></div>
          </div>
        </div>
        <div class="filter-group">
          <label>Categoria</label>
          <div class="checks" id="filtro-cat">
            <div class="row"><input type="checkbox" value="Camisetas" checked> <span>Camisetas</span></div>
            <div class="row"><input type="checkbox" value="Cal√ßas" checked> <span>Cal√ßas</span></div>
            <div class="row"><input type="checkbox" value="Vestidos" checked> <span>Vestidos</span></div>
            <div class="row"><input type="checkbox" value="Jaquetas" checked> <span>Jaquetas</span></div>
            <div class="row"><input type="checkbox" value="Acess√≥rios" checked> <span>Acess√≥rios</span></div>
          </div>
        </div>
        <div class="filter-group">
          <label>Pre√ßo m√°x. (R$)</label>
          <div class="range">
            <input type="range" id="range-preco" min="30" max="1200" step="10" value="1200" />
            <span id="preco-out">1200</span>
          </div>
        </div>
        <button class="btn ghost" id="btnReset">Limpar filtros</button>
      </section>

      <div class="footer">‚öôÔ∏è Conecte com seu broker MQTT/WebSocket para ler tags RFID/IoT reais. Esta √© uma simula√ß√£o
        pronta para produ√ß√£o.</div>
    </aside>

    <!-- MAIN -->
    <main class="main">
      <section class="header">
        <div class="title">
          <h2>Financeiro/Estoque: Fluxo & Arara</h2>
        </div>
        <div class="actions">
          <button class="btn ghost" id="btnIot">Conectar IoT (simular)</button>
          <button class="btn pri" id="btnAdd">Adicionar Item</button>
        </div>
      </section>

      <!-- KPIs -->
      <section class="grid kpis" style="margin-top:14px">
        <article class="card">
          <h4>Valor em Estoque</h4>
          <div class="big" id="kpiValor">‚Äî</div>
          <div class="trend" id="kpiValorTrend">Atualizado em tempo real</div>
        </article>
        <article class="card">
          <h4>Total de Unidades</h4>
          <div class="big" id="kpiUnidades">‚Äî</div>
          <div class="trend">Soma de todas as pe√ßas</div>
        </article>
        <article class="card">
          <h4>Itens com Baixo Estoque</h4>
          <div class="big" id="kpiBaixo">‚Äî</div>
          <div class="trend">Abaixo de 5 unidades</div>
        </article>
      </section>

      <!-- CHARTS TOP -->
      <section class="grid charts" style="margin-top:16px">
        <article class="card">
          <h4>Movimenta√ß√µes por Per√≠odo</h4>
          <canvas id="chartFluxo"></canvas>
        </article>
        <article class="card">
          <h4>Estoque por Categoria</h4>
          <canvas id="chartPizza"></canvas>
        </article>
      </section>

      <!-- ARARA + TOP 5 -->
      <section class="grid split" style="margin-top:16px">
        <article class="card">
          <h4>Arara Inteligente (visual)</h4>
          <div class="rack">
            <div class="poste left"></div>
            <div class="poste right"></div>
            <div class="barra"></div>
            <div id="rackHangers"></div>
          </div>
          <div style="display:flex; gap:10px; align-items:center; margin-top:8px">
            <div class="status-dot" style="background:var(--ok)"></div><span class="trend">OK (‚â•10)</span>
            <div class="status-dot" style="background:var(--warn)"></div><span class="trend">Baixo (&lt;10)</span>
            <div class="status-dot" style="background:var(--danger)"></div><span class="trend">Cr√≠tico (&lt;5)</span>
          </div>
        </article>
        <article class="card">
          <h4>Top 5 por Valor Total</h4>
          <canvas id="chartBar"></canvas>
        </article>
      </section>

      <!-- TABELA -->
      <section class="card" style="margin-top:16px">
        <div class="toolbar">
          <input class="search" id="search" placeholder="Buscar por nome, tag, categoria‚Ä¶" />
          <select class="input" id="sort">
            <option value="-valor">Ordenar: Valor desc</option>
            <option value="valor">Ordenar: Valor asc</option>
            <option value="nome">Ordenar: Nome</option>
            <option value="-quantidade">Ordenar: Quantidade desc</option>
            <option value="quantidade">Ordenar: Quantidade asc</option>
          </select>
        </div>
        <div style="overflow:auto; margin-top:10px">
          <table>
            <thead>
              <tr>
                <th>Tag</th>
                <th>Pe√ßa</th>
                <th>Categoria</th>
                <th>Pre√ßo</th>
                <th>Qtd</th>
                <th>Arara</th>
                <th>√öltima mov.</th>
                <th>Valor Total</th>
                <th>A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
      </section>
    </main>
  </div>
  <!-- ================== RELAT√ìRIOS PERSONALIZADOS ================== -->
  <section id="relatorios" class="card p-4 mt-6">
    <h2 class="text-xl font-bold mb-4">üìä Relat√≥rios Personalizados</h2>

    <!-- Filtros -->
    <div class="flex gap-4 flex-wrap mb-4">
      <div>
        <label>Data Inicial</label>
        <input type="date" id="dataInicio" class="input">
      </div>
      <div>
        <label>Data Final</label>
        <input type="date" id="dataFim" class="input">
      </div>
      <div>
        <label>Tipo de Relat√≥rio</label>
        <select id="tipoRelatorio" class="input">
          <option value="vendas">Vendas</option>
          <option value="compras">Compras</option>
          <option value="estoque">Estoque Baixo</option>
          <option value="valor">Valoriza√ß√£o de Itens</option>
        </select>
      </div>
      <div>
        <label>Categoria</label>
        <select id="categoriaRelatorio" class="input">
          <option value="">Todas</option>
          <option value="camisetas">Camisetas</option>
          <option value="calcas">Cal√ßas</option>
          <option value="sapatos">Sapatos</option>
        </select>
      </div>
      <div class="flex items-end">
        <button onclick="gerarRelatorio()" class="btn">Gerar Relat√≥rio</button>
      </div>
    </div>

    <!-- Resultado -->
    <div id="resultadoRelatorio" class="overflow-auto"></div>

    <!-- Exporta√ß√£o -->
    <div class="mt-4 flex gap-2">
      <button onclick="exportarPDF()" class="btn">üìÑ Exportar PDF</button>
      <button onclick="exportarExcel()" class="btn">üìä Exportar Excel</button>
    </div>
  </section>


  <!-- MODAL ADD/EDIT -->
  <dialog id="modal">
    <form method="dialog">
      <h3 style="margin:8px 0 12px">Novo/Editar Item</h3>
      <div class="modal-body">
        <div>
          <label>Tag (RFID)</label>
          <input class="input" id="mTag" placeholder="0001" />
        </div>
        <div>
          <label>Pe√ßa</label>
          <input class="input" id="mNome" placeholder="Camiseta Oversize" />
        </div>
        <div>
          <label>Categoria</label>
          <select class="input" id="mCat">
            <option>Camisetas</option>
            <option>Cal√ßas</option>
            <option>Vestidos</option>
            <option>Jaquetas</option>
            <option>Acess√≥rios</option>
          </select>
        </div>
        <div>
          <label>Pre√ßo (R$)</label>
          <input class="input" id="mPreco" type="number" step="0.01" />
        </div>
        <div>
          <label>Quantidade</label>
          <input class="input" id="mQtd" type="number" />
        </div>
        <div>
          <label>Arara/Setor</label>
          <input class="input" id="mArara" placeholder="A1" />
        </div>
      </div>
      <div class="modal-actions">
        <button class="btn ghost" value="cancel">Cancelar</button>
        <button class="btn pri" id="mSalvar" value="default">Salvar</button>
      </div>
    </form>
  </dialog>
  <!-- ================== RELAT√ìRIOS PERSONALIZADOS ================== -->
  <section id="relatorios" class="card p-4 mt-6">
    <h2 class="text-xl font-bold mb-4">üìä Relat√≥rios Personalizados</h2>

    <!-- Filtros -->
    <div class="flex gap-4 flex-wrap mb-4">
      <div>
        <label>Data Inicial</label>
        <input type="date" id="dataInicio" class="input">
      </div>
      <div>
        <label>Data Final</label>
        <input type="date" id="dataFim" class="input">
      </div>
      <div>
        <label>Tipo de Relat√≥rio</label>
        <select id="tipoRelatorio" class="input">
          <option value="vendas">Vendas</option>
          <option value="compras">Compras</option>
          <option value="estoque">Estoque Baixo</option>
          <option value="valor">Valoriza√ß√£o de Itens</option>
        </select>
      </div>
      <div>
        <label>Categoria</label>
        <select id="categoriaRelatorio" class="input">
          <option value="">Todas</option>
          <option value="camisetas">Camisetas</option>
          <option value="calcas">Cal√ßas</option>
          <option value="sapatos">Sapatos</option>
        </select>
      </div>
      <div class="flex items-end">
        <button onclick="gerarRelatorio()" class="btn">Gerar Relat√≥rio</button>
      </div>
    </div>

    <!-- Resultado -->
    <div id="resultadoRelatorio" class="overflow-auto"></div>

    <!-- Exporta√ß√£o -->
    <div class="mt-4 flex gap-2">
      <button onclick="exportarPDF()" class="btn">üìÑ Exportar PDF</button>
      <button onclick="exportarExcel()" class="btn">üìä Exportar Excel</button>
    </div>
  </section>

  <script src="js/js.js"></script>
</body>

</html>